openapi: 3.0.0
info:
  title: Index Rows
  description: API endpoint for indexing rows from a Beefree template
  version: 1.0.0
servers:
  - url: https://api.getbee.io
    description: Base URL for the API
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: Enter Dev Console API Key as Bearer token
paths:
  /v1/{collection}/merge/index:
    post:
      summary: Index Rows
      description: Reference an array of metadata objects from a Beefree template in JSON format.              
      security:
        - bearerAuth: []
      parameters:
        - name: collection
          in: path
          required: true
          description: The collection ID or name
          schema:
            type: string
      requestBody:
        required: true
        description: JSON payload containing the Beefree template
        content:
          application/json:
            schema:
              type: object
              required:
                - source
              properties:
                source:
                  description: A Beefree template in JSON format
                  type: object
            example:
              source:
                page:
                  body:
                    container:
                      style:
                        background-color: '#FFFFFF'
                    content:
                      computedStyle:
                        linkColor: '#FF819C'
                        messageBackgroundColor: transparent
                        messageWidth: 675px
                      style:
                        color: '#000000'
                        font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif
                    type: mailup-bee-page-properties
                    webFonts:
                    - fontFamily: "'Montserrat', 'Trebuchet MS', 'Lucida Grande', 'Lucida Sans Unicode', 'Lucida Sans', Tahoma, sans-serif"
                      name: Montserrat
                      url: https://fonts.googleapis.com/css?family=Montserrat
                  description: BF-ecommerce-template
                  rows:
                  - columns:
                    - grid-columns: 6
                      modules:
                      - descriptor:
                          computedStyle:
                            class: center fixedwidth
                            width: 338
                          image:
                            alt: Image
                            href: https://beefree.io
                            src: https://d1oco4z2z1fhwp.cloudfront.net/templates/default/113/logo_1.png
                          style:
                            padding-bottom: 0px
                            padding-left: 15px
                            padding-right: 15px
                            padding-top: 5px
                            width: 100%
                        locked: false
                        type: mailup-bee-newsletter-modules-image
                      - descriptor:
                          computedStyle:
                            align: center
                            hideContentOnMobile: true
                          divider:
                            style:
                              border-top: 0px solid transparent
                              height: 20px
                              width: 100%
                          style:
                            padding-bottom: 10px
                            padding-left: 10px
                            padding-right: 10px
                            padding-top: 10px
                        locked: false
                        type: mailup-bee-newsletter-modules-divider
                      style:
                        background-color: transparent
                        padding-bottom: 0px
                        padding-left: 0px
                        padding-right: 0px
                        padding-top: 30px
                    container:
                      style:
                        background-color: '#FF819C'
                        background-image: none
                        background-position: top left
                        background-repeat: no-repeat
                    content:
                      computedStyle:
                        hideContentOnDesktop: false
                        hideContentOnMobile: false
                        rowColStackOnMobile: true
                      style:
                        background-color: transparent
                        color: '#333'
                        width: 675px
                    locked: false
                    metadata:
                      guid: test3
                      name: demo3
                    type: two-columns-empty
                  template:
                    name: template-base
                    type: basic
                    version: 2.0.0
                  title: BF-ecommerce-template
      responses:
        '200':
          description: An array of metadata objects containing row details
          content:
            application/json:
              example:
              - guid: test3
                name: demo3
      examples:
        NodeJS:
          summary: NodeJS Request Example
          value: |
            const response = await fetch('https://api.getbee.io/v1/{collection}/merge/index', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer <token>' },
              body: JSON.stringify({
                "source": {
                  "page": {
                    "body": {
                      "container": {
                        "style": {
                          "background-color": "#FFFFFF"
                        }
                      },
                      "content": {
                        "computedStyle": {
                          "linkColor": "#FF819C",
                          "messageBackgroundColor": "transparent",
                          "messageWidth": "675px"
                        },
                        "style": {
                          "color": "#000000",
                          "font-family": "Arial, 'Helvetica Neue', Helvetica, sans-serif"
                        }
                      },
                      "webFonts": [
                        {
                          "fontFamily": "'Montserrat', 'Trebuchet MS', 'Lucida Grande', 'Lucida Sans Unicode', 'Lucida Sans', Tahoma, sans-serif",
                          "name": "Montserrat",
                          "url": "https://fonts.googleapis.com/css?family=Montserrat"
                        }
                      ]
                    },
                    "rows": [
                      {
                        "columns": [
                          {
                            "grid-columns": 6,
                            "modules": [
                              {
                                "descriptor": {
                                  "computedStyle": {
                                    "class": "center fixedwidth",
                                    "width": 338
                                  },
                                  "image": {
                                    "alt": "Image",
                                    "href": "https://beefree.io",
                                    "src": "https://d1oco4z2z1fhwp.cloudfront.net/templates/default/113/logo_1.png"
                                  },
                                  "style": {
                                    "padding-bottom": "0px",
                                    "padding-left": "15px",
                                    "padding-right": "15px",
                                    "padding-top": "5px",
                                    "width": "100%"
                                  }
                                },
                                "type": "mailup-bee-newsletter-modules-image"
                              }
                            ],
                            "style": {
                              "background-color": "transparent",
                              "padding-top": "30px"
                            }
                          }
                        ],
                        "metadata": {
                          "guid": "test3",
                          "name": "demo3"
                        },
                        "type": "two-columns-empty"
                      }
                    ]
                  }
                }
              }),
            });
            const result = await response.json();
            console.log(result); // Log the response metadata objects
